<!DOCTYPE html><html lang="en-US" class="h-full"> <head><meta charset="utf-8"><meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport"><meta content="IE=edge" http-equiv="X-UA-Compatible"><title>Azure Project: Billing Orchestration at Scale â€¢ josh quiachon</title><link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ’¼</text></svg>"><!-- <link rel='preload' href='/fonts/Satoshi-Variable.ttf' as='font' type='font/ttf' crossorigin />
	<link
		rel='preload'
		href='/fonts/Satoshi-VariableItalic.ttf'
		as='font'
		type='font/ttf'
		crossorigin
	/>
	<link rel='preload' href='/fonts/ClashDisplay-Variable.ttf' as='font' type='font/ttf' crossorigin /> --><link rel="canonical" href="http://quiachonj.github.io/blog/billing_orchestration/"><meta content="Azure Project: Billing Orchestration at Scale â€¢ josh quiachon" name="title"><meta content="Systems Design" name="description"><meta content="josh quiachon" name="author"><meta content="" name="theme-color"><meta content="website" property="og:type"><meta content="Azure Project: Billing Orchestration at Scale" property="og:title"><meta content="Systems Design" property="og:description"><meta content="http://quiachonj.github.io/blog/billing_orchestration/" property="og:url"><meta content="josh quiachon" property="og:site_name"><meta content="en_US" property="og:locale"><meta content="http://quiachonj.github.io/social-card.png" property="og:image"><meta content="1200" property="og:image:width"><meta content="630" property="og:image:height"><meta content="summary_large_image" property="twitter:card"><meta content="http://quiachonj.github.io/blog/billing_orchestration/" property="twitter:url"><meta content="Azure Project: Billing Orchestration at Scale" property="twitter:title"><meta content="Systems Design" property="twitter:description"><meta content="http://quiachonj.github.io/social-card.png" property="twitter:image"><link href="/sitemap-index.xml" rel="sitemap"><link href="/rss.xml" rel="alternate" title="josh quiachon" type="application/rss+xml"><meta content="Astro v5.13.7" name="generator"><link rel="stylesheet" href="/_astro/index.BnHOQooy.css"><script type="module" src="/_astro/page.BBc6vbNQ.js"></script>
<script>window.va = window.va || function () { (window.vaq = window.vaq || []).push(arguments); };
		var script = document.createElement('script');
		script.defer = true;
		script.src = '/_vercel/insights/script.js';
		var head = document.querySelector('head');
		head.appendChild(script);
	</script></head><body class="flex h-full justify-center bg-primary"> <script>
	const lightModePref = window.matchMedia('(prefers-color-scheme: light)');

	// Get user preference from local storage or from browser preference
	function getUserPref() {
		const storedTheme = localStorage.getItem('theme') ?? undefined;
		return storedTheme || (lightModePref.matches ? 'light' : 'dark');
	}

	function setTheme(newTheme) {
		if (newTheme !== 'light' && newTheme !== 'dark') {
			return console.log(`Invalid theme value '${newTheme}' received. Expected 'light' or 'dark'.`);
		}

		localStorage.setItem('theme', newTheme);

		const root = document.documentElement;

		// if current dark theme and new theme is dark, return
		if (newTheme === 'dark' && root.classList.contains('dark')) {
			return;
		} else if (newTheme === 'light' && !root.classList.contains('dark')) {
			return;
		}

		root.classList.toggle('dark');
	}

	// Initial Setup
	setTheme(getUserPref());

	// View Transitions hook to restore theme
	document.addEventListener('astro:after-swap', () => setTheme(getUserPref()));

	// Listen for theme-change custom event
	document.addEventListener('theme-change', (e) => {
		setTheme(e.detail.theme);
	});

	// Listen for prefers-color-scheme change
	lightModePref.addEventListener('change', (e) => setTheme(e.matches ? 'light' : 'dark'));
</script> <main class="flex w-screen flex-col items-center px-5 pt-5 font-satoshi leading-relaxed text-secondary-foreground md:px-0 lg:max-w-7xl"> <header class="lg:max-w-7xl w-full md:fixed z-20 bg-background-tertiary text-secondary-foreground shadow-xl dark:shadow-black/50 border rounded-2xl border-none flex flex-col justify-center" x-data="{ open: false }"> <nav class="grid grid-cols-2 p-5 md:grid-cols-3" aria-label="global"> <a class="flex flex-row items-center justify-start text-2xl font-semibold uppercase" href="/" aria-label="joshquiachon">josh<span class="text-accent-300">quia</span>chon<span class="text-accent-300">blog</span></a> <div class="col-span-1 flex flex-row items-center justify-end md:col-span-2"> <div class="z-10 hidden flex-row gap-5 pr-5 md:flex"> <a href="/" class="flex-none text-[1.05rem] font-medium hover:text-accent-300" aria-label="About">About
</a> <a href="/blog" class="flex-none text-[1.05rem] font-medium hover:text-accent-300" aria-label="Blog">Blog
</a> </div> <div> <button id="toggleDarkMode" class="rounded-md border border-border bg-background-tertiary p-1.5 transition-all hover:bg-accent-300"> <span class="sr-only">Dark Theme</span> <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all hover:text-white dark:hidden dark:-rotate-90 dark:scale-0"><path fill="currentColor" d="M12 15q1.25 0 2.125-.875T15 12q0-1.25-.875-2.125T12 9q-1.25 0-2.125.875T9 12q0 1.25.875 2.125T12 15m0 1q-1.671 0-2.836-1.164T8 12q0-1.671 1.164-2.836T12 8q1.671 0 2.836 1.164T16 12q0 1.671-1.164 2.836T12 16m-7-3.5H1.5v-1H5zm17.5 0H19v-1h3.5zM11.5 5V1.5h1V5zm0 17.5V19h1v3.5zM6.746 7.404l-2.16-2.098l.695-.744l2.111 2.134zM18.72 19.438l-2.117-2.14l.652-.702l2.16 2.098zM16.596 6.746l2.098-2.16l.744.695l-2.134 2.111zM4.562 18.72l2.14-2.117l.663.652l-2.078 2.179zM12 12"></path></svg> <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="hidden h-[1.2rem] w-[1.2rem] rotate-90 scale-0 text-white transition-all dark:block dark:rotate-0 dark:scale-100"><path fill="currentColor" d="M12.058 20q-3.334 0-5.667-2.333Q4.058 15.333 4.058 12q0-3.038 1.98-5.27Q8.02 4.5 10.942 4.097q.081 0 .159.006t.153.017q-.506.706-.801 1.57q-.295.865-.295 1.811q0 2.667 1.866 4.533q1.867 1.867 4.534 1.867q.952 0 1.813-.295q.862-.295 1.548-.801q.012.075.018.153q.005.078.005.158q-.384 2.923-2.615 4.904T12.057 20"></path></svg> </button> <button id="toggleMobileMenu" class="top-5 rounded-md border border-border bg-background-tertiary p-1.5 shadow-xl transition-all hover:bg-accent-300 dark:shadow-black/50 md:hidden" x-on:click="open = !open"> <span class="sr-only">Menu</span> <svg width="1em" height="1em" x-show="!open" class="h-[1.2rem] w-[1.2rem] transition-all dark:text-white" data-icon="menu">   <symbol id="ai:local:menu" viewBox="0 0 50 50"><path fill="currentColor" d="M3 9a1 1 0 1 0 0 2h44a1 1 0 1 0 0-2zm0 15a1 1 0 1 0 0 2h44a1 1 0 1 0 0-2zm0 15a1 1 0 1 0 0 2h44a1 1 0 1 0 0-2z"/></symbol><use href="#ai:local:menu"></use>  </svg> <svg width="1em" height="1em" x-show="open" class="h-[1.2rem] w-[1.2rem] transition-all dark:text-white" data-icon="close">   <symbol id="ai:local:close" viewBox="0 0 50 50"><path fill="currentColor" d="M7.719 6.281 6.28 7.72 23.563 25 6.28 42.281l1.44 1.439L25 26.438l17.281 17.28 1.438-1.437L26.438 25l17.28-17.281-1.437-1.438L25 23.563Z"/></symbol><use href="#ai:local:close"></use>  </svg> </button> </div> </div> </nav> <nav id="mobile_menu" x-collapse x-show="open" x-transition class="mt-1.5 flex flex-grow flex-col items-center justify-between gap-4 rounded-xl bg-background-tertiary p-5 text-secondary-foreground shadow-xl dark:shadow-black/50 md:hidden"> <a href="/" class="flex-none text-[1.05rem] font-medium hover:text-accent-300" aria-label="About">About
</a> <a href="/blog" class="flex-none text-[1.05rem] font-medium hover:text-accent-300" aria-label="Blog">Blog
</a> </nav> </header> <script type="module" src="/_astro/HeaderBlog.astro_astro_type_script_index_0_lang.CR6jsWIQ.js"></script> <div class="mt-5 w-full p-5 md:mt-[5.5rem]">  <div class="w-full bg-primary text-secondary-foreground"> <a class="inline-flex items-center gap-x-1 rounded-lg bg-accent-200/30 text-secondary-foreground border border-border px-2 py-1 text-sm transition-all hover:bg-input" href="/blog" data-astro-prefetch="true"> <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24"> <path fill="currentColor" d="m6.921 12.5l5.792 5.792L12 19l-7-7l7-7l.713.708L6.921 11.5H19v1z"></path> </svg> <p>Back</p>  </a> <div class="mt-8 gap-x-10 lg:flex lg:items-start"> <aside class="sticky top-32 order-2 -me-28 hidden flex-grow text-secondary-foreground lg:flex lg:flex-col"> <h2 class="font-semibold">Table of Contents</h2> <ul class="text-card-foreground"> <li class> <a aria-label="Scroll to section: Billing Consolidation" class="block line-clamp-2  mt-2 text-foreground/75 transition-all hover:text-foreground" href="#billing-consolidation">Billing Consolidation</a> <ul> <li class="ms-2"> <a aria-label="Scroll to section: The Challenge" class="block line-clamp-2  mt-1 text-sm text-foreground/75 transition-all hover:text-foreground" href="#the-challenge">The Challenge</a> <ul> <li class="ms-2"> <a aria-label="Scroll to section: Common Pitfalls" class="block line-clamp-2  mt-1 text-sm text-foreground/75 transition-all hover:text-foreground" href="#common-pitfalls">Common Pitfalls</a>  </li> </ul> </li><li class="ms-2"> <a aria-label="Scroll to section: My Role" class="block line-clamp-2  mt-1 text-sm text-foreground/75 transition-all hover:text-foreground" href="#my-role">My Role</a>  </li><li class="ms-2"> <a aria-label="Scroll to section: Solution Highlights" class="block line-clamp-2  mt-1 text-sm text-foreground/75 transition-all hover:text-foreground" href="#solution-highlights">Solution Highlights</a>  </li><li class="ms-2"> <a aria-label="Scroll to section: Justification" class="block line-clamp-2  mt-1 text-sm text-foreground/75 transition-all hover:text-foreground" href="#justification">Justification</a>  </li><li class="ms-2"> <a aria-label="Scroll to section: Cost in Mind" class="block line-clamp-2  mt-1 text-sm text-foreground/75 transition-all hover:text-foreground" href="#cost-in-mind">Cost in Mind</a>  </li><li class="ms-2"> <a aria-label="Scroll to section: Letâ€™s observe and optimize" class="block line-clamp-2  mt-1 text-sm text-foreground/75 transition-all hover:text-foreground" href="#lets-observe-and-optimize">Letâ€™s observe and optimize</a>  </li><li class="ms-2"> <a aria-label="Scroll to section: Design Philosophy" class="block line-clamp-2  mt-1 text-sm text-foreground/75 transition-all hover:text-foreground" href="#design-philosophy">Design Philosophy</a>  </li><li class="ms-2"> <a aria-label="Scroll to section: Impact" class="block line-clamp-2  mt-1 text-sm text-foreground/75 transition-all hover:text-foreground" href="#impact">Impact</a>  </li> </ul> </li> </ul> </aside> <article class="flex-grow break-words" data-pagefind-body> <div id="blog-hero"><div class="flex flex-wrap items-center gap-x-3 gap-y-2"> <p class="text-xs"> <time datetime="2025-07-02T00:00:00.000Z"> JULY 1, 2025 </time> /  5 min read </p> </div> <h1 class="mt-2 text-3xl font-medium sm:mb-1"> Azure Project: Billing Orchestration at Scale </h1> <div class="mt-3 flex flex-row items-center gap-x-1"> <svg aria-hidden="true" class="me-1 inline-block h-6 w-6" fill="none" focusable="false" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"> <path d="M0 0h24v24H0z" fill="none" stroke="none"></path> <path d="M7.859 6h-2.834a2.025 2.025 0 0 0 -2.025 2.025v2.834c0 .537 .213 1.052 .593 1.432l6.116 6.116a2.025 2.025 0 0 0 2.864 0l2.834 -2.834a2.025 2.025 0 0 0 0 -2.864l-6.117 -6.116a2.025 2.025 0 0 0 -1.431 -.593z"></path> <path d="M17.573 18.407l2.834 -2.834a2.025 2.025 0 0 0 0 -2.864l-7.117 -7.116"></path> <path d="M6 9h-.01"></path> </svg> <div> <a class="inline-flex items-center gap-x-1 rounded-lg bg-accent-200/30 text-secondary-foreground border border-border px-2 py-1 text-sm transition-all hover:bg-input" href="/tags/software architecture/" data-astro-prefetch="true">  <p>#software architecture</p>  </a>   </div><div> <a class="inline-flex items-center gap-x-1 rounded-lg bg-accent-200/30 text-secondary-foreground border border-border px-2 py-1 text-sm transition-all hover:bg-input" href="/tags/full stack development/" data-astro-prefetch="true">  <p>#full stack development</p>  </a>   </div><div> <a class="inline-flex items-center gap-x-1 rounded-lg bg-accent-200/30 text-secondary-foreground border border-border px-2 py-1 text-sm transition-all hover:bg-input" href="/tags/software engineering/" data-astro-prefetch="true">  <p>#software engineering</p>  </a>   </div><div> <a class="inline-flex items-center gap-x-1 rounded-lg bg-accent-200/30 text-secondary-foreground border border-border px-2 py-1 text-sm transition-all hover:bg-input" href="/tags/azure data factory/" data-astro-prefetch="true">  <p>#azure data factory</p>  </a>   </div><div> <a class="inline-flex items-center gap-x-1 rounded-lg bg-accent-200/30 text-secondary-foreground border border-border px-2 py-1 text-sm transition-all hover:bg-input" href="/tags/adf/" data-astro-prefetch="true">  <p>#adf</p>  </a>  </div> </div> </div> <div class="prose prose-base prose-zinc mt-12 text-muted-foreground dark:prose-invert prose-headings:font-medium prose-headings:text-foreground prose-headings:before:absolute prose-headings:before:-ms-4 prose-th:before:content-none">  <p>As organizations scale, billing complexity tends to grow with them. Multiple systems, each with its own cadence, logic, and data model, often coexist across business units. Creating fragmented customer experiences and operational inefficiencies. Manual reconciliation, brittle integrations, and delayed invoicing become the norm. The challenge isnâ€™t just technical. Itâ€™s strategic: how do you unify billing across diverse systems without compromising availability or introducing rigid dependencies?</p>
<h2 id="billing-consolidation">Billing Consolidation</h2>
<blockquote>
<p>Billing Orchestration at Scale, Modern Billing Without the Bloat</p>
</blockquote>
<p>For smaller companies or those with specialized billing needs, traditional ERP platforms like Microsoft Dynamics or PeopleSoft often feel like overkill. Costly, rigid, and slow to evolve. These teams need systems that work with them, not against them: lightweight, modular, and built to flex around unique workflows. I architect orchestration layers that support this agility. Leveraging loosely coupled services, event-driven triggers, and cloud-native components that scale with demand but remain lean enough for rapid iteration. Whether billing is usage-based, subscription-driven, or entirely custom, the infrastructure adapts without locking teams into heavyweight tooling or vendor dependencies.</p>
<h3 id="the-challenge">The Challenge</h3>
<p>A client with multiple legacy billing systems across business units were creating reconciliation delays, operational overhead, and fragmented customer experiences. The goal was to consolidate billing logic into a unified, scalable orchestration layer without compromising uptime or introducing brittle dependencies.</p>
<h4 id="common-pitfalls">Common Pitfalls</h4>
<p>Many organizations underestimate the complexity of billing consolidation by treating it as a simple data migration or API stitching exercise. They often:</p>
<ul>
<li>Over-index on consistency at the expense of availability, leading to brittle systems that fail under load or partial outages</li>
<li>Hard-code business logic into monoliths or tightly coupled services, making future integrations painful and error-prone</li>
<li>Ignore asynchronous workflows, assuming all billing events can be processed in real time without retries or compensation</li>
<li>Neglect observability, leaving teams blind to failures in distributed workflows and reconciliation gaps</li>
<li>Delay architectural decisions, patching legacy systems until scale forces a reactive overhaul</li>
</ul>
<p>By addressing these head-on, I design systems that embrace eventual consistency, favor modular orchestration, and scale gracefully with business growth.</p>
<blockquote>
<p>If your company is navigating these challenges or starting to feel the strain of legacy billing systems, I can help. Iâ€™ve worked hands-on with teams to design resilient, scalable billing architectures that donâ€™t just patch problems, but lay the groundwork for long-term growth. Whether youâ€™re exploring modernization, rethinking orchestration, or just trying to make sense of where the bottlenecks are, Iâ€™m always open to a thoughtful conversation.</p>
</blockquote>
<h3 id="my-role">My Role</h3>
<p>Led architecture and implementation of a cloud-native billing orchestration platform using Azure services. Designed for high availability, eventual consistency, and modular extensibility to support future integrations.</p>
<h3 id="solution-highlights">Solution Highlights</h3>
<ul>
<li>Azure Durable Functions for orchestrating long-running billing workflows with built-in retry and state management.</li>
<li>Azure Service Bus to decouple microservices and ensure resilient message delivery across billing events.</li>
<li>Cosmos DB with multi-region writes to support eventual consistency and low-latency access across geographies.</li>
<li>Azure API Management to expose unified billing endpoints while enforcing throttling, caching, and security policies.</li>
<li>Custom retry logic and idempotency controls to handle transient failures and ensure billing accuracy without duplication.</li>
</ul>
<h3 id="justification">Justification</h3>
<ul>
<li>Durable Functions: Excellent for orchestrating long-running workflows with built-in state and retry. You avoid paying for idle time on the Consumption plan.</li>
<li>Service Bus: Great choice for decoupling and ensuring delivery guarantees. It scales well and supports dead-lettering and retries.</li>
<li>Cosmos DB (multi-region writes): Supports global distribution and low-latency reads, which is ideal for geo-spanning billing.</li>
<li>API Management: Centralized control over throttling, caching, and security which is critical for exposing billing endpoints.</li>
<li>Custom retry/idempotency: Essential for billing accuracy and avoiding duplicate charges.</li>
</ul>
<h3 id="cost-in-mind">Cost in Mind</h3>
<ol>
<li>Durable Functions</li>
</ol>
<ul>
<li>Use sub-orchestrators to isolate replay-heavy logic and reduce execution overhead.</li>
<li>Consider Premium Plan if workflows are frequent and replay-heavy-no replay billing and better performance.</li>
<li>Avoid excessive fan-out/fan-in patterns unless absolutely necessary.</li>
</ul>
<ol start="2">
<li>Service Bus</li>
</ol>
<ul>
<li>Batch messages where possible to reduce transaction costs.</li>
<li>Use sessions for ordered processing to avoid spinning up multiple consumers unnecessarily.</li>
<li>Auto-delete idle queues/topics to avoid lingering costs.</li>
</ul>
<ol start="3">
<li>Cosmos DB</li>
</ol>
<ul>
<li>Evaluate if multi-region writes are essential. If most writes originate from one region, consider single-region writes with multi-region reads.</li>
<li>Use autoscale throughput instead of provisioned RU/s to avoid over-provisioning during off-peak hours.</li>
<li>Optimize indexing policies: Index only whatâ€™s queried. Exclude large fields and use composite indexes for multi-field queries.</li>
<li>TTL (Time-to-Live) for ephemeral data can reduce storage costs.</li>
</ul>
<ol start="4">
<li>API Management</li>
</ol>
<ul>
<li>Use caching aggressively for read-heavy endpoints to reduce backend calls.</li>
<li>Choose the right tier: Developer tier for dev/test, Consumption tier for lightweight workloads, and Premium only if multi-region or VNET integration is required.</li>
<li>Offload static content to CDN or blob storage when possible.</li>
</ul>
<ol start="5">
<li>Retry &#x26; Idempotency</li>
</ol>
<ul>
<li>Centralize retry logic in orchestrators or middleware to avoid redundant retries across layers.</li>
<li>Use durable entities or state stores to track idempotency keys efficiently.</li>
</ul>
<h3 id="lets-observe-and-optimize">Letâ€™s observe and optimize</h3>
<ul>
<li>Use Application Insights and Azure Monitor to track execution patterns, identify hot paths, and optimize function durations.</li>
<li>Set budget alerts and cost anomaly detection to catch unexpected spikes early.</li>
</ul>
<h3 id="design-philosophy">Design Philosophy</h3>
<p>Prioritized availability over strict consistency, aligning with the business need for uninterrupted billing operations. Leveraged event-driven architecture to isolate failures, enable graceful degradation, and support asynchronous reconciliation.</p>
<h3 id="impact">Impact</h3>
<ul>
<li>Reduced billing latency by 35%</li>
<li>Enabled seamless onboarding of new billing sources with minimal code changes</li>
<li>Improved system resilience and observability across distributed components</li>
</ul>  </div> </article> </div> <button aria-label="Back to Top" class="z-90 fixed bottom-8 end-4 flex h-8 w-8 translate-y-28 items-center justify-center rounded-full border-2 border-transparent bg-secondary-foreground text-3xl text-primary-foreground opacity-0 transition-all duration-300 hover:border-border/75 data-[show=true]:translate-y-0 data-[show=true]:opacity-100 sm:end-8 sm:h-12 sm:w-12" data-show="false" id="to-top-btn"><svg aria-hidden="true" class="h-4 w-4" fill="none" focusable="false" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"> <path d="M4.5 15.75l7.5-7.5 7.5 7.5" stroke-linecap="round" stroke-linejoin="round"></path> </svg> </button>  </div>  </div> <button aria-label="Back to Top" class="z-90 fixed bottom-8 end-4 flex h-8 w-8 translate-y-28 items-center justify-center rounded-full border-2 border-transparent bg-secondary-foreground text-3xl text-primary-foreground opacity-0 transition-all duration-300 hover:border-border/75 data-[show=true]:translate-y-0 data-[show=true]:opacity-100 sm:end-8 sm:h-12 sm:w-12" data-show="false" id="to-top-btn"><svg aria-hidden="true" class="h-4 w-4" fill="none" focusable="false" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"> <path d="M4.5 15.75l7.5-7.5 7.5 7.5" stroke-linecap="round" stroke-linejoin="round"></path> </svg> </button> <script type="module">const e=document.getElementById("to-top-btn"),n=document.getElementById("blog-hero");function c(t){t.forEach(o=>{e.dataset.show=(!o.isIntersecting).toString()})}e.addEventListener("click",()=>{document.documentElement.scrollTo({behavior:"smooth",top:0})});const r=new IntersectionObserver(c);r.observe(n);</script> <footer class="mx-auto mt-24 w-full px-5"> <div class="border-t border-border py-5"> <div class="flex flex-col items-center gap-y-3 sm:flex sm:flex-row sm:items-center sm:justify-between sm:gap-y-0"> <div class="text-center md:text-right">Â© 2025 Josh Quiachon</div> </div> </div> </footer> </main> </body></html>