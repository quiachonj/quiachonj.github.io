---
import { cn } from '@/utils';
import { Icon } from 'astro-icon/components';

const { class: className } = Astro.props;

const nav = [
  { href: '/', label: 'About', aria: 'About' },
  { href: '/blog', label: 'Blog', aria: 'Blog' }
];
---

<header
  x-data="{ open: false }"
  class={cn(
    className,
    'w-full lg:max-w-7xl md:fixed top-0 z-20 bg-background-tertiary text-secondary-foreground shadow-xl dark:shadow-black/50 rounded-2xl'
  )}
>
  <nav class="flex items-center justify-between p-5" aria-label="global">
    <a
      href="/"
      aria-label="joshquiachon"
      class="flex items-center text-2xl font-semibold uppercase"
    >
      <span class="text-accent-300">josh quiachon blog</span>
    </a>

    <div class="flex items-center gap-3">
      <!-- Desktop nav -->
      <ul class="hidden md:flex items-center gap-6 pr-4">
        {nav.map(({ href, label, aria }) => (
          <li>
            <a
              href={href}
              aria-label={aria}
              class="text-[1.05rem] font-medium hover:text-accent-300"
            >
              {label}
            </a>
          </li>
        ))}
      </ul>

      <!-- Theme toggle -->
      <button
        id="toggleDarkMode"
        class="rounded-md border border-border bg-background-tertiary p-1.5 transition-all hover:bg-accent-300"
      >
        <span class="sr-only">Toggle dark theme</span>
        <!-- Sun -->
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24" height="24" viewBox="0 0 24 24"
          class="h-[1.2rem] w-[1.2rem] transition-all dark:hidden"
        >
          <path fill="currentColor" d="M12 15q1.25 0 2.125-.875T15 12q0-1.25-.875-2.125T12 9q-1.25 0-2.125.875T9 12q0 1.25.875 2.125T12 15m0 1q-1.671 0-2.836-1.164T8 12q0-1.671 1.164-2.836T12 8q1.671 0 2.836 1.164T16 12q0 1.671-1.164 2.836T12 16M5 12H2.5v-1H5zm16.5 0H19v-1h2.5zM11.5 5V2.5h1V5zm0 16.5V19h1v2.5zM6.746 7.404l-2.16-2.098l.695-.744l2.111 2.134zM18.72 19.438l-2.117-2.14l.652-.702l2.16 2.098zM16.596 6.746l2.098-2.16l.744.695l-2.134 2.111zM4.562 18.72l2.14-2.117l.663.652l-2.078 2.179z"/>
        </svg>
        <!-- Moon -->
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24" height="24" viewBox="0 0 24 24"
          class="hidden h-[1.2rem] w-[1.2rem] text-white transition-all dark:block"
        >
          <path fill="currentColor" d="M12.058 20q-3.334 0-5.667-2.333Q4.058 15.333 4.058 12q0-3.038 1.98-5.27Q8.02 4.5 10.942 4.097q.081 0 .159.006t.153.017q-.506.706-.801 1.57q-.295.865-.295 1.811q0 2.667 1.866 4.533q1.867 1.867 4.534 1.867q.952 0 1.813-.295q.862-.295 1.548-.801q.012.075.018.153q.005.078.005.158q-.384 2.923-2.615 4.904T12.057 20"/>
        </svg>
      </button>

      <!-- Mobile menu toggle -->
      <button
        id="toggleMobileMenu"
        aria-controls="mobile_menu"
        :aria-expanded="open.toString()"
        x-on:click="open = !open"
        class="rounded-md border border-border bg-background-tertiary p-1.5 shadow-xl transition-all hover:bg-accent-300 dark:shadow-black/50 md:hidden"
      >
        <span class="sr-only">Menu</span>
        <Icon name="menu" x-show="!open" class="h-[1.2rem] w-[1.2rem] transition-all dark:text-white" />
        <Icon name="close" x-show="open" class="h-[1.2rem] w-[1.2rem] transition-all dark:text-white" />
      </button>
    </div>
  </nav>

  <!-- Mobile nav -->
  <nav
    id="mobile_menu"
    x-collapse
    x-show="open"
    x-transition
    class="md:hidden mt-1.5 rounded-xl bg-background-tertiary p-5 text-secondary-foreground shadow-xl dark:shadow-black/50"
  >
    <ul class="flex flex-col items-center gap-4">
      {nav.map(({ href, label, aria }) => (
        <li>
          <a
            href={href}
            aria-label={aria}
            class="text-[1.05rem] font-medium hover:text-accent-300"
            x-on:click="open = false"
          >
            {label}
          </a>
        </li>
      ))}
    </ul>
  </nav>
</header>

<script>
  import '../../scripts/toggleTheme';
</script>
